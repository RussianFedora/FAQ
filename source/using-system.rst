.. Fedora-Faq-Ru (c) 2018, EasyCoding Team and contributors
.. 
.. Fedora-Faq-Ru is licensed under a
.. Creative Commons Attribution-ShareAlike 4.0 International License.
.. 
.. You should have received a copy of the license along with this
.. work. If not, see <https://creativecommons.org/licenses/by-sa/4.0/>.
.. _using-system:

*************************************************************
Вопросы, связанные с работой в системе и администрированием
*************************************************************

.. index:: автодополнение
.. _autocompletion:

У меня в системе не работает автодополнение команд. Как исправить?
=====================================================================

Необходимо установить пакет sqlite:

.. code-block:: bash

    sudo dnf install sqlite

При определённых условиях он может не быть установлен и из-за этого система автоматического дополнения команд может перестать функционировать.

.. index:: параметры ядра, kernel options
.. _kernelpm-once:

Как однократно передать параметр ядра?
=========================================

Для передачи параметра необходимо в меню загрузчика Grub 2 выбрать нужную строку и нажать клавишу **E** на клавиатуре для перехода к её редактированию, затем в конце через пробел дописать нужный параметр (или параметры), после чего нажать **Enter**, чтобы начать процесс загрузки.

.. index:: параметры ядра, kernel options
.. _kernelpm-perm:

Как мне задать параметр ядра для постоянного использования?
=================================================================

Необходимо открыть с шаблонами загрузчика **/etc/default/grub** в любом текстовом редакторе, найти в нём переменную **GRUB_CMDLINE_LINUX** и внести соответствующие правки. После этого нужно пересобрать конфиг Grub 2 посредством **grub2-mkconfig**.

.. index:: журнал системы, journald
.. _journal-current:

Как мне посмотреть текущий журнал работы системы?
====================================================

Чтобы посмотреть журнал работы системы с момента загрузки, нужно выполнить:

.. code-block:: bash

    journalctl -b

Чтобы посмотреть только журнал работы ядра (аналог dmesg):

.. code-block:: bash

    journalctl -k

.. index:: журнал системы, journald
.. _journal-history:

Как мне посмотреть журналы с прошлых загрузок?
====================================================

Вывести список всех загрузок:

.. code-block:: bash

    journalctl --list-boots

Вывести содержимое журнала загрузки с идентификатором **X**:

.. code-block:: bash

    journalctl -b -X

.. index:: журнал системы, journald
.. _journal-tofile:

Как мне выгрузить журнал в файл?
======================================

Необходимо перенаправить поток стандартного вывода в файл:

.. code-block:: bash

    journalctl -b > ~/abc.txt

Также можно воспользоваться утилитой fpaste для автоматической загрузки файла на сервис `fpaste.org <https://paste.fedoraproject.org/>`__:

.. code-block:: bash

    journalctl -b | fpaste

При успешном выполнении будет создана ссылка для быстрого доступа.

.. index:: резервное копирование, backup
.. _backup-system:

Можно ли делать резервную копию корневого раздела работающей системы?
=========================================================================

Настоятельно не рекомендуется из-за множества работающих виртуальных файловых систем и псевдофайлов в **/sys**, **/dev**, **/proc** и т.д.

.. index:: резервное копирование, backup
.. _backup-home:

Как сделать копию домашнего каталога?
=========================================

См. `здесь <https://www.easycoding.org/2017/09/03/avtomatiziruem-rezervnoe-kopirovanie-v-fedora.html>`__.

.. index:: резервное копирование, backup
.. _backup-create:

Как лучше всего делать резервную копию корневого раздела?
=============================================================

Необходимо загрузиться с LiveCD или LiveUSB, смонтировать раздел с корневой файловой системой и выполнить:

.. code-block:: bash

    sudo tar --one-file-system --selinux \
    --exclude="$bdir/tmp/*" \
    --exclude="$bdir/var/tmp/*" \
    -cvJpf /путь/к/бэкапу.tar.xz -C /путь/к/корню .

.. index:: chroot
.. _chroot:

Как сделать chroot в установленную систему с LiveUSB?
===========================================================

Загружаемся с LiveCD/USB и запускаем эмулятор терминала или переходим в виртуальную консоль (особой разницы не имеет).

Для начала создадим каталог для точки монтирования:

.. code-block:: bash

    sudo mkdir /media/fedora

Смонтируем корневой раздел установленной ОС:

.. code-block:: bash

    sudo mount -t ext4 /dev/sda1 /media/fedora

Здесь **/dev/sda1** - раздел, на котором установлена ОС, а **ext4** - его файловая система. Внесём соответствующие правки если это не так.

Переходим в каталог с корневой ФС и монтируем ряд необходимых для работы окружения виртуальных ФС:

.. code-block:: bash

    cd /media/fedora
    sudo mount -t proc /proc proc
    sudo mount --rbind /sys sys
    sudo mount --make-rslave sys
    sudo mount --rbind /dev dev
    sudo mount --make-rslave dev
    sudo mount -t tmpfs tmpfs tmp

Теперь выполняем вход в chroot:

.. code-block:: bash

    sudo chroot /media/fedora

Выполняем нужные действия, а по окончании завершаем работу chroot окружения:

.. code-block:: bash

    logout

Отмонтируем раздел:

.. code-block:: bash

    sudo umount /media/fedora

.. index:: initrd, пересобрать initrd
.. _initrd-rebuild:

Как мне пересобрать образ initrd?
====================================

Для пересборки образа initrd следует выполнить:

.. code-block:: bash

    sudo dracut -f

.. index:: boot, загрузчик, grub
.. _grub-reinstall:

Как мне переустановить Grub 2?
====================================

См. `здесь <https://fedoraproject.org/wiki/GRUB_2>`__.

.. index:: boot, загрузчик, grub
.. _grub-rebuild:

Как пересобрать конфиг Grub 2?
====================================

Пересборка конфига Grub 2 для legacy конфигураций:

.. code-block:: bash

    sudo grub2-mkconfig -o /boot/grub2/grub.cfg

Пересборка конфигра Grub 2 для UEFI конфигураций:

.. code-block:: bash

    sudo grub2-mkconfig -o /boot/efi/EFI/fedora/grub.cfg

.. index:: drivers, драйверы, nut, UPS, ИБП
.. _configure-ups:

Как настроить ИБП (UPS) в Fedora?
====================================

См. `здесь <https://www.easycoding.org/2012/10/01/podnimaem-nut-v-linux.html>`__.

.. index:: ssh, keys, error, ошибка
.. _ssh-keys-error:

При использовании SSH появляется ошибка доступа к ключам. Как исправить?
===========================================================================

См. `здесь <https://www.easycoding.org/2016/07/31/reshaem-problemu-s-ssh-klyuchami-v-fedora-24.html>`__.

.. index:: slow shutdown, медленное завершение работы
.. _slow-shutdown:

Система медленно завершает работу. Можно ли это ускорить?
============================================================

См. `здесь <https://www.easycoding.org/2016/08/08/uskoryaem-zavershenie-raboty-fedora-24.html>`__.

.. index:: journald, журналы, ограничение размера журналов
.. _journald-limit:

Системные журналы занимают слишком много места. Как их ограничить?
=====================================================================

См. `здесь <https://www.easycoding.org/2016/08/24/ogranichivaem-sistemnye-zhurnaly-v-fedora-24.html>`__.

.. index:: firewalld, port forwarding, проброс порта
.. _firewalld-port-forwarding:

Как пробросить локальный порт на удалённый хост?
====================================================

См. `здесь <https://www.easycoding.org/2017/05/23/probrasyvaem-lokalnyj-port-na-udalyonnyj-xost.html>`__.

.. index:: openvpn
.. _using-openvpn:

Как поднять OpenVPN сервер в Fedora?
=======================================

См. `здесь <https://www.easycoding.org/2017/07/24/podnimaem-ovn-server-na-fedora.html>`__. В данной статье вместо **ovn** следует использовать **openvpn** во всех путях и именах юнитов.

.. index:: systemd
.. _systemd-info:

Что такое systemd и как с ним работать?
==========================================

См. `здесь <https://www.easycoding.org/2017/11/05/upravlyaem-systemd-v-fedora.html>`__.

.. index:: bug, missing library, libcurl-gnutls
.. _libcurl-workaround:

Как решить проблему с отсутствием библиотеки libcurl-gnutls.so.4?
=====================================================================

См. `здесь <https://www.easycoding.org/2018/04/03/reshaem-problemu-otsutstviya-libcurl-gnutls-v-fedora.html>`__.

.. index:: server, matrix, сервер
.. _matrix-server:

Как поднять свой сервер Matrix в Fedora?
===========================================

См. `здесь <https://www.easycoding.org/2018/04/15/podnimaem-sobstvennyj-matrix-server-v-fedora.html>`__.

.. index:: firefox, hardware acceleration
.. _firefox-hwaccel:

Как активировать аппаратное ускорение в браузере Firefox?
=============================================================

Для активации аппаратного ускорения рендеринга страниц в Mozilla Firefox на поддерживаемых драйверах необходимо открыть модуль конфигурации **about:config** и исправить значения следующих переменных (при отсутствии создать):

.. code-block:: text

    layers.acceleration.force-enabled = true
    layers.offmainthreadcomposition.enabled = true
    webgl.force-enabled = true
    gfx.xrender.enabled = true

Изменения вступят в силу при следующем запуске браузера.

Внимание! Это не затрагивает аппаратное декодирование мультимедиа средствами видеоускорителя.

.. index:: firefox, chromium, chrome, hardware acceleration, vaapi
.. _browser-hwaccel:

Как активировать аппаратное ускорение декодирования мультимедиа в браузерах?
===============================================================================

В настоящее время аппаратное ускорение декодирования мультимедиа "из коробки" в GNU/Linux не поддерживается ни в одном браузере.

В Mozilla Firefox оно вообще не реализовано: `MZBZ#563206 <https://bugzilla.mozilla.org/show_bug.cgi?id=563206>`__ и `MZBZ#1210727 <https://bugzilla.mozilla.org/show_bug.cgi?id=1210727>`__.

В Google Chrome и Chromium частично реализовано, но отключено на этапе компиляции и без особых VA-API патчей недоступно. Репозиторий :ref:`RPM Fusion <rpmfusion>` предоставляет такую сборку Chromium. Для её установки необходимо подключить его и установить пакет **chromium-vaapi**:

.. code-block:: bash

    sudo dnf install chromium-vaapi

Далее необходимо запустить его, зайти в **chrome://flags** и установить пункт **Hardware decoding** в значение **Enabled**, после чего перезапустить браузер.

.. index:: mpv, video player, hardware acceleration, vaapi, vdpau
.. _video-hwaccel:

В каких проигрывателях реализовано аппаратное ускорение декодирования мультимедиа?
=====================================================================================

Полная поддержка аппаратного декодирования мультимедиа средствами VA-API (Intel, AMD) или VPDAU (NVIDIA) реализована в проигрывателях VLC и mpv.

Для активации данной функции необходимо в качестве графического бэкэнда вывода изображения указать **vaapi** или **vdpau**, после чего перезапустить плеер.

.. index:: gdb, debugging, отладка
.. _debug-application:

Приложение падает. Как мне его отладить?
===========================================

Для начала рекомендуется (хотя и не обязательно) установить отладочную информацию для данного пакета:

.. code-block:: bash

    sudo dnf debuginfo-install foo-bar

После завершения процесса отладки символы можно снова удалить.

Чтобы получить бэктрейс падения, нужно выполнить в терминале:

.. code-block:: bash

    gdb /usr/bin/foo-bar 2>&1 | tee ~/backtrace.log

Далее в интерактивной консоли отладчика ввести: **handle SIGPIPE nostop noprint** и затем **run**, дождаться сегфолта и выполнить **bt full** для получения бэктрейса. Теперь можно прописать **quit** для выхода из режима отладки.

Далее получившийся файл **~/backtrace.log** следует загрузить на любой сервис размещения текстовых файлов.

Также рекомендуется ещё сделать трассировку приложения до момента падения:

.. code-block:: bash

    strace -o ~/trace.log /usr/bin/foo-bar

Полученный файл **~/trace.log** также следует загрузить на сервис.

.. index:: fs, caches, сброс кэшей ФС
.. _drop-fs-caches:

Как очистить кэши и буферы всех файловых систем?
===================================================

Чтобы очистить кэши и буферы нужно выполнить:

.. code-block:: bash

    sync && echo 3 > /proc/sys/vm/drop_caches && sync

.. index:: converting multiple files, конвертирование множества файлов
.. _convert-multiple-files:

Как конвертировать множество файлов в mp3 из текущего каталога?
===================================================================

Конвертируем все файлы с маской \*.ogg в mp3 в текущем каталоге:

.. code-block:: bash

    find . -maxdepth 1 -type f -name "*.ogg" -exec ffmpeg -i "{}" -acodec mp3 -ab 192k "$(basename {}).mp3" \;

.. index:: timezone, utc, hardware clock
.. _system-time-utc:

Как настроить системные часы в UTC или локального времени и наоборот?
========================================================================

Переключение аппаратных часов компьютера в UTC из localtime:

.. code-block:: bash

    sudo timedatectl set-local-rtc no

Переключение аппаратных часов компьютера в localtime из UTC:

.. code-block:: bash

    sudo timedatectl set-local-rtc yes

.. index:: timezone, utc, hardware clock
.. _windows-utc:

У меня в дуалбуте с Fedora установлена Windows и часы постоянно сбиваются. В чём дело?
=========================================================================================

Чтобы такого не происходило, обе операционные системы должны хранить время в формате UTC. Для этого в Windows нужно применить следующий файл реестра:

.. code-block:: text

    Windows Registry Editor Version 5.00
    
    [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\TimeZoneInformation]
    "RealTimeIsUniversal"=dword:00000001

.. index:: drivers, disable driver, отключение драйвера
.. _driver-disable:

Как можно навсегда отключить определённый драйвер?
=====================================================

Чтобы навсегда отключить какой-то драйвер в Linux, необходимо создать файл в каталоге **/etc/modprobe.d** с любым именем, например **disable-nv.conf**, и примерно таким содержанием:

.. code-block:: text

    install nouveau /bin/false

Здесь вместо **nouveau** нужно указать реально используемые устройством драйверы.

Полный список загруженных драйверов можно получить так:

.. code-block:: bash

    lspci -nnk

Теперь необходимо пересобрать inird образ:

.. code-block:: bash

    sudo dracut --force

Чтобы отменить действие, достаточно удалить созданный файл и снова пересобрать initrd.

.. index:: server, web server
.. _simple-web-server:

Как запустить простейший веб-сервер в Fedora?
================================================

Для запуска простейшего веб-сервера можно использовать Python и модуль, входящий в состав базового пакета:

.. code-block:: bash

    python3 -m http.server 8080

Веб-сервер будет запущен на порту **8080**. В качестве webroot будет использоваться текущий рабочий каталог.

.. index:: kde, gtk, double-click, двойной клик
.. _double-click-speed:

Я использую KDE. Как мне настроить скорость двойного клика в GTK приложениях?
==================================================================================

Для настройки GTK 2 приложений необходимо открыть файл **~/.gtkrc-2.0** в любом текстовом редакторе (если он отсутствует — создать), затем прописать в самом конце:

.. code-block:: text

    gtk-double-click-time=1000

Для GTK 3 нужно редактировать **~/.config/gtk-3.0/settings.ini**. В нём следует прописать то же самое:

.. code-block:: text

    gtk-double-click-time=1000

Здесь 1000 — время в миллисекундах до активации двойного клика. Документация с подробным описанием всех переменных данных файлов конфигурации `здесь <https://developer.gnome.org/gtk3/stable/GtkSettings.html>`__.

.. index:: console, lock screen, lock session, блокировка сессии
.. _block-screen:

Возможно ли заблокировать экран из командной строки?
=======================================================

Да:

.. code-block:: bash

    loginctl lock-session

.. index:: console, change hostname, изменение имени хоста, имя хоста
.. _change-hostname:

Как изменить имя хоста?
==========================

Изменение имени хоста возможно посредством **hostnamectl**:

.. code-block:: bash

    hostnamectl set-hostname NEW

Здесь вместо **NEW** следует указать новое значение. Изменения вступят в силу немедленно.

.. index:: network, настройка сети
.. _network-configuration:

Как лучше настраивать сетевые подключения?
=============================================

В Fedora для настройки сети используется Network Manager. Для работы с ним доступны как графические менеджеры (встроены в каждую DE), так и консольный **nm-cli**.

.. index:: bash, приветствие оболочки
.. _bash-shell:

Можно ли изменить приветствие Bash по умолчанию?
===================================================

Да, необходимо в пользовательский файл **~/.bashrc** добавить строку вида:

.. code-block:: text

    export PS1="\[\e[33m\][\[\e[36m\]\u\[\e[0m\]@\[\e[31m\]\h\[\e[0m\] \[\e[32m\]\W\[\e[33m\]]\[\e[35m\]\$\[\e[0m\] "

Существует удобный онлайн генератор таких строк `здесь <http://bashrcgenerator.com/>`__.

.. index:: bash, title, заголовок оболочки
.. _bash-title:

Можно ли из shell скрипта менять название терминала?
=======================================================

Да, при помощи `управляющих последовательностей <https://ru.wikipedia.org/wiki/%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D1%8F%D1%8E%D1%89%D0%B8%D0%B5_%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8_ANSI>`__. Ими же можно менять цвет текста вывода и многое другое.

.. index:: time, синхронизация времени, ntp
.. _configure-ntp:

Как настроить синхронизацию времени?
=======================================

В Fedora для этой цели используется chronyd, который установлен и запущен по умолчанию.

Чтобы узнать включена ли синхронизация времени с NTP серверами, можно использовать утилиту **timedatectl**.

Если синхронизация отключена, нужно убедиться, что сервис chronyd активирован:

.. code-block:: bash

    sudo systemctl enable chronyd.service

Получить список NTP серверов, с которыми осуществляется синхронизация, можно так:

.. code-block:: bash

    chronyc sources

.. index:: systemd, скорость запуска
.. _systemd-analyze:

Как узнать какой сервис замедляет загрузку системы?
======================================================

.. code-block:: bash

    systemd-analyze blame

.. index:: multimedia, encoding, nvidia
.. _nvidia-encoding:

Как ускорить кодирование видео с использованием видеокарт NVIDIA?
====================================================================

Для этого нужно установить ffmpeg, а также проприетарные драйверы NVIDIA из репозиториев :ref:`RPM Fusion <rpmfusion>`.

Использование NVENC:

.. code-block:: bash

    ffmpeg -i input.mp4 -acodec aac -ac 2 -ab 128k -vcodec h264_nvenc -profile high444p -pixel_format yuv444p -preset default output.mp4

Использование CUDA/CUVID:

.. code-block:: bash

    ffmpeg -c:v h264_cuvid -i input.mp4 -c:v h264_nvenc -preset slow output.mkv

Здесь **input.mp4** — имя оригинального файла, который требуется перекодировать, а в **output.mp4** будет сохранён результат.

Больше информации можно найти `здесь <https://trac.ffmpeg.org/wiki/HWAccelIntro>`__.

.. index:: filesystem, check, проверка файловой системы, lvm
.. _fs-check-lvm:

Как мне проверить ФС в составе LVM с LiveUSB?
==================================================

Если файловая система была повреждена, необходимо запустить **fsck** и разрешить ему исправить её. При использовании настроек по умолчанию (LVM, ФС ext4) это делается так:

.. code-block:: bash

    fsck -t ext4 /dev/mapper/fedora-root
    fsck -t ext4 /dev/mapper/fedora-home

Если вместо ext4 применяется другая файловая система, необходимо указать её после параметра **-t**.

.. index:: filesystem, check, проверка файловой системы
.. _fs-check-partitions:

Как мне проверить ФС при использовании классических разделов с LiveUSB?
==========================================================================

Если используется классическая схема с обычными разделами, то утилите **fsck** необходимо передавать соответствующее блочное устройство, например:

.. code-block:: bash

    fsck -t ext4 /dev/sda2
    fsck -t ext4 /dev/sda3

Если вместо **ext4** применяется другая файловая система, необходимо указать её после параметра **-t**. Также вместо **/dev/sda2** следует прописать соответствующее блочное устройство с повреждённой ФС.

Полный список доступных устройств хранения данных можно получить:

.. code-block:: bash

    sudo fdisk -l


.. index:: filesystem, check, проверка файловой системы, luks
.. _fs-check-luks:

Как мне проверить ФС на зашифрованном LUKS разделе с LiveUSB?
================================================================

Если используются зашифрованные LUKS разделы, то сначала откроем соответствующее устройство:

.. code-block:: bash

    cryptsetup luksOpen /dev/sda2 luks-root

Здесь вместо **/dev/sda2** следует прописать соответствующее блочное устройство зашифрованного накопителя.

Теперь запустим проверку файловой системы:

.. code-block:: bash

    fsck -t ext4 /dev/mapper/luks-root

Если вместо **ext4** применяется другая файловая система, необходимо указать её после параметра **-t**.

По окончании обязательно отключим LUKS том:

.. code-block:: bash

    cryptsetup luksClose /dev/mapper/luks-root

.. index:: file system, выбор файловой системы, файловая система
.. _fs-selection:

Какую файловую систему рекомендуется использовать на Fedora?
================================================================

По умолчанию применяется `ext4 <https://ru.wikipedia.org/wiki/Ext4>`__. На наш взгляд, это самая стабильная и популярная файловая система в настоящее время.

Для хранения больших объёмов данных можно использовать `XFS <https://ru.wikipedia.org/wiki/XFS>`__.

.. index:: file system, файловая система, btrfs
.. _fs-btrfs:

Что вы скажете о BTRFS?
===========================

Мы настоятельно не рекомендуем её использовать. Данная ФС очень нестабильна и часто приводит к полной потере всех данных на устройстве без возможности восстановления даже в идеальных условиях (было множество случаев у пользователей нашего канала).

.. index:: window, borders, рамки окон, kde plasma
.. _window-borders:

Как убрать рамки внутри окон в KDE Plasma 5?
===============================================

Для этого следует открыть **Меню KDE** - **Компьютер** - **Параметры системы** - **Оформление приложений** - страница **Стиль интерфейса** - кнопка **Настроить** - вкладка **Рамки**, **убрать все флажки** из чекбоксов на данной странице и нажать кнопку **OK**.

.. index:: window, gnome, масштабирование, scaling factor, hidpi, qt
.. _window-hidpi-qt:

У меня в Gnome не работает масштабирование окон Qt приложений. Что делать?
=============================================================================

Для активации автоматического масштабирования достаточно прописать в файле **~/.bashrc** следующие строки:

.. code-block:: text

    export QT_AUTO_SCREEN_SCALE_FACTOR=1
    export QT_SCALE_FACTOR=2

Переменная **QT_AUTO_SCREEN_SCALE_FACTOR** имеет тип boolean (значения **1** (включено) или **0** (выключено)) и управляет автоматическим масштабированием в зависимости от разрешения экрана.

Переменная **QT_SCALE_FACTOR** задаёт коэффициент масштабирования:

 * **1.5** - 150%;
 * **1.75** - 175%;
 * **2** - 200%;
 * **2.5** - 250%;
 * **3** - 300%.

Более подробную информацию можно найти в `документации Qt <https://doc.qt.io/qt-5/highdpi.html>`__.

.. index:: multimedia, dlna, server, сервер мультимедиа
.. _dlna-server:

Как поднять DLNA сервер в локальной сети?
============================================

См. `здесь <https://www.easycoding.org/2018/09/08/podnimaem-dlna-server-v-fedora.html>`__.

.. index:: telegram
.. _telegram-fedora:

Как лучше установить Telegram Desktop в Fedora?
===================================================

Мы настоятельно рекомендуем устанавливать данный мессенджер исключительно из :ref:`RPM Fusion <rpmfusion>`:

.. code-block:: bash

    sudo dnf install telegram-desktop

Данная версия собрана и динамически слинкована с использованием исключительно штатных системных библиотек, доступных в репозиториях Fedora, а не давно устаревших и уязвимых версий из комплекта Ubuntu 14.04, как официальная.

Сборка Fedora поддерживает системные настройки тем, правильное сглаживание шрифтов (за счёт использование общесистемных настроек) и не имеет проблем со скоростью запуска.

.. index:: telegram, cleanup
.. _telegram-cleanup:

Ранее я устанавливал официальную версию Telegram Desktop. Как мне очистить её остатки?
=========================================================================================

Официальная версия с сайта создаёт ярлыки запуска и копирует ряд загруженных бинарных файлов в пользовательский домашний каталог. Избавимся от этого:

 1. удалим старый бинарник и модуль обновления официального клиента, а также их копии из **~/.local/share/TelegramDesktop** и **~/.local/share/TelegramDesktop/tdata**;
 2. удалим ярлыки из **~/.local/share/applications**.

Теперь можно установить :ref:`версию <telegram-fedora>` из :ref:`RPM Fusion <rpmfusion>`.

.. index:: memory depuplication, дедупликация памяти
.. _deduplication-memory:

Возможна ли полная дедупликация оперативной памяти?
=======================================================

Да, дедупликация памяти `поддерживается <https://www.ibm.com/developerworks/linux/library/l-kernel-shared-memory/index.html>`__ в ядре Linux начиная с версии 2.6.32 модулем `KSM <https://ru.wikipedia.org/wiki/KSM>`__ и по умолчанию применяется лишь в системах виртуализации, например в KVM.

.. index:: disk depuplication, дедупликация данных
.. _deduplication-disk:

Возможна ли полная дедупликация данных на дисках?
=====================================================

Полная автоматическая дедупликация данных на дисках `поддерживается <https://btrfs.wiki.kernel.org/index.php/Deduplication>`__ лишь файловой системой :ref:`BTRFS <fs-btrfs>`.

.. index:: zram, сжатие памяти, memory compression
.. _memory-compression:

Можно ли включить сжатие оперативной памяти?
================================================

Да, в ядро Linux начиная с версии 3.14 по умолчанию входит модуль zram, который позволяет увеличить производительность системы посредством использования вместо дисковой подкачки виртуального устройства в оперативной памяти с активным сжатием.

Включение zram в Fedora:

.. code-block:: bash

    sudo systemctl enable --now zram-swap

Отключение zram в Fedora:

.. code-block:: bash

    sudo systemctl stop zram-swap
    sudo systemctl disable zram-swap

После использования вышеуказанных команд рекомендуется выполнить перезагрузку системы.

.. index:: sddm, dm, disable virtual keyboard, отключение виртуальной клавиатуры
.. _sddm-disable-vkb:

Как отключить виртуальную клавиатуру в SDDM?
=================================================

Чтобы отключить поддержку ввода с виртуальной экранной клавиатуры в менеджере входа в систему SDDM, откроем в текстовом редакторе файл **/etc/sddm.conf**, а затем найдём и удалим следующую строку:

.. code-block:: text

    InputMethod=qtvirtualkeyboard

Если она отсутствует, создадим в блоке **[General]**:

.. code-block:: text

    InputMethod=

Изменения вступят в силу при следующей загрузке системы.

.. index:: file system, файловая система, exfat, fuse
.. _fedora-exfat:

Почему я не могу использовать файловую систему exFAT в Fedora?
===================================================================

Файловая система exFAT защищена множеством патентов Microsoft, поэтому она не может быть включена в ядро Linux и соответственно быть доступной в Fedora по умолчанию.

Для того, чтобы использовать её, необходимо установить пакет **fuse-exfat** из :ref:`репозитория <3rd-repositories>` :ref:`RPM Fusion <rpmfusion>`:

.. code-block:: bash

    sudo dnf install fuse fuse-exfat

.. index:: network speed, скорость сети, iperf
.. _fedora-iperf:

Как сделать замеры скорости локальной или беспроводной сети?
================================================================

Для точных замеров производительности сети нам потребуется как минимум два компьютера (либо компьютер и мобильное устройство), а также утилита iperf, присутствующая в репозиториях Fedora. Установим её:

.. code-block:: bash

    sudo dnf install iperf2

На первом устройстве запустим сервер iperf:

.. code-block:: bash

    iperf -s

По умолчанию iperf прослушивает порт **5001/tcp** на всех доступных сетевых соединениях.

Теперь временно разрешим входящие соединения на данный порт посредством :ref:`Firewalld <firewalld-about>` (правило будет действовать до перезагрузки):

.. code-block:: bash

    sudo firewall-cmd --add-port=5001/tcp

На втором устройстве запустим клиент и подключимся к серверу:

.. code-block:: text

    iperf -c 192.168.1.2

В качестве клиента может выступать и мобильное устройство на базе ОС Android с установленным `Network Tools <https://play.google.com/store/apps/details?id=net.he.networktools>`__. В этом случае в главном меню программы следует выбрать пункт **Iperf2**, а в окне подключения ввести:

.. code-block:: text

    -c 192.168.1.2

Параметр **-c** обязателен. Если он не указан, программа выдаст ошибку.

**192.168.1.2** - это внутренний IP-адрес устройства в ЛВС, на котором запущен сервер. Номер порта указывать не требуется.

.. index:: latex, editor, редактор
.. _latex-editor:

В репозиториях есть полнофункциональные редакторы LaTeX?
===========================================================

Да. Для работы с документами в формате LaTeX рекомендуется использовать **texmaker**:

.. code-block:: bash

    sudo dnf install texmaker

.. index:: latex, texlive, cyrillic, fonts, шрифты
.. _latex-cyrillic:

Как установить поддержку кириллических шрифтов для LaTeX?
=============================================================

Наборы кириллических шрифтов доступны в виде коллекции:

.. code-block:: bash

    sudo dnf install texlive-collection-langcyrillic texlive-cyrillic texlive-russ texlive-babel-russian

.. index:: fuse, file system, mtp, android, phone
.. _fuze-mtp:

Как подключить смартфон на Android посредством протокола MTP?
================================================================

Для простой и удобной работы с файловой системой смартфона вне зависимости от используемых приложений, рабочей среды и файлового менеджера, мы рекомендуем использовать основанную на FUSE реализацию.

Установим пакет **jmtpfs**:

.. code-block:: bash

    sudo dnf install jmtpfs fuse

Создадим каталог, в который будет смонтирована ФС смартфона:

.. code-block:: bash

    mkdir -p ~/myphone

Подключим устройство к компьютеру или ноутбуку по USB, разблокируем его и выберем режим MTP, после чего выполним:

.. code-block:: bash

    jmtpfs ~/myphone

По окончании работы обязательно завершим MTP сессию:

.. code-block:: bash

    fusermount -u ~/myphone

.. index:: systemd, failed to start modules, kernel, virtualbox
.. _failed-to-start:

При загрузке системы появляется ошибка Failed to start Load Kernel Modules. Как исправить?
==============================================================================================

Это известная проблема системы виртуализации VirtualBox, использующей out-of-tree модули ядра, но может также проявляться и у пользователей проприетарных :ref:`драйверов Broadcom <broadcom-drivers>`.

Для исправления необходимо **после каждого обновления ядра** выполнять пересборку initrd:

.. code-block:: bash

    sudo dracut -f

Для вступления изменений в силу требуется перезагрузка:

.. code-block:: bash

    sudo systemctl reboot

.. index:: sysctl, kernel option
.. _sysctl-temporary:

Как временно изменить параметр sysctl?
==========================================

Временно установить любой параметр ядра возможно через sysctl:

.. code-block:: bash

    sudo sysctl -w foo.bar=X

Здесь **foo.bar** имя параметра, а **X** - его значение. Изменения вступят в силу немедленно и сохранятся до перезагрузки системы.

.. index:: sysctl, kernel option
.. _sysctl-permanent:

Как задать и сохранить параметр sysctl?
===========================================

Чтобы сохранить параметр ядра, создадим специальный файл **99-foobar.conf** в каталоге **/etc/sysctl.d**:

.. code-block:: text

    foo.bar1=X1
    foo.bar2=X2

Каждый параметр должен быть указан с новой строки. Здесь **foo.bar** имя параметра, а **X** - его значение.

Для вступления изменений в силу требуется перезагрузка:

.. code-block:: bash

    sudo systemctl reboot

.. index:: sysctl, kernel option
.. _sysctl-order:

В каком порядке загружаются sysctl файлы настроек?
======================================================

При загрузке ядро проверяет следующие каталоги в поисках **.conf** файлов:

 1. **/usr/lib/sysctl.d** - предустановленные конфиги системы и определённых пакетов;
 2. **/run/sysctl.d** - различные конфиги, сгенерированные в рантайме;
 3. **/etc/sysctl.d** - пользовательские конфиги.

Порядок выполнения - в алфавитном порядке, поэтому для его изменения многие конфиги содержат цифры и буквы. Например конфиг **00-foobar.conf** выполнится раньше, чем **zz-foobar.conf**.

.. index:: keyring, kwallet, wallet
.. _kwallet-pam:

Как настроить автоматическую разблокировку связки ключей KWallet при входе в систему?
=========================================================================================

KDE предоставляет особый PAM модуль для автоматической разблокировки связки паролей KDE Wallet при входе в систему. Установим его:

.. code-block:: bash

    sudo dnf install pam-kwallet

Запустим менеджер KWallet (**Параметры системы** - группа **Предпочтения пользователя** - **Учётная запись** - страница **Бумажник** - кнопка **Запустить управление бумажниками**), нажмём кнопку **Сменить пароль** и укажем тот же самый пароль, который используется для текущей учётной записи.

Сохраняем изменения и повторно входим в систему.

.. index:: video, youtube, download
.. _youtube-download:

Как скачать видео с Youtube?
=================================

Скачать любое интересующее видео с Youtube, а также ряда других хостингов, можно посредством утилиты **youtube-dl**, доступной в основном репозитории Fedora:

.. code-block:: bash

    sudo dnf install youtube-dl

Скачивание видео с настройками по умолчанию в наилучшем качестве:

.. code-block:: bash

    youtube-dl -f bestvideo https://www.youtube.com/watch?v=XXXXXXXXXX

Данная утилита имеет множество параметров командной строки, справку по которым можно найти в её странице man:

.. code-block:: bash

    man youtube-dl

Для выхода из окна просмотра справки достаточно нажать **Q**.
